<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>نموذج تسجيل المحل</title>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Axios -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
  body {
    background: #121212;
    color: #eee;
    font-family: Arial, sans-serif;
  }
  form {
    max-width: 500px;
    margin: 2rem auto;
    background: #222;
    padding: 20px;
    border-radius: 8px;
  }
  label {
    display: block;
    margin: 10px 0 5px;
  }
  select, input, button {
    width: 100%;
    padding: 8px;
    background: #333;
    border: none;
    color: #eee;
    border-radius: 5px;
    margin-bottom: 15px;
  }
  button {
    background: #0a84ff;
    cursor: pointer;
    font-weight: bold;
  }
</style>
</head>
<body>

<form id="registerForm">
  <h2>تسجيل المحل / البيج</h2>

  <label for="name">اسم المحل / البيج</label>
  <input type="text" id="name" name="name" placeholder="أدخل اسم المحل" required />

  <label for="phone">رقم الهاتف</label>
  <input type="tel" id="phone" name="phone" placeholder="مثال: 077xxxxxxxx" required />

  <label for="province">اختر المحافظة</label>
  <select id="province" name="province" required>
    <option value="">-- اختر المحافظة --</option>
    <option value="بغداد">بغداد</option>
    <option value="البصرة">البصرة</option>
    <option value="النجف">النجف</option>
    <option value="نينوى">نينوى</option>
    <option value="كركوك">كركوك</option>
    <option value="صلاح الدين">صلاح الدين</option>
    <option value="ديالى">ديالى</option>
    <option value="ميسان">ميسان</option>
    <option value="ذي قار">ذي قار</option>
    <option value="القادسية">القادسية</option>
    <option value="بابل">بابل</option>
    <option value="الأنبار">الأنبار</option>
    <option value="الكرمة">الكرمة</option>
    <option value="واسط">واسط</option>
    <option value="الحلة">الحلة</option>
    <option value="الديوانية">الديوانية</option>
    <option value="أربيل">أربيل</option>
    <option value="السليمانية">السليمانية</option>
    <option value="دهوك">دهوك</option>
    <!-- يمكن إضافة المزيد إذا تريد -->
  </select>

  <label for="baghdad_side" id="baghdadSideLabel" style="display:none;">اختر جانب بغداد</label>
  <select id="baghdad_side" name="baghdad_side" style="display:none;">
    <option value="">-- اختر --</option>
    <option value="الرصافة">الرصافة</option>
    <option value="الكرخ">الكرخ</option>
  </select>

  <label for="baghdad_area" id="baghdadAreaLabel" style="display:none;">اختر المنطقة</label>
  <select id="baghdad_area" name="baghdad_area" style="display:none;">
    <option value="">-- اختر --</option>
    <option value="الأولى">الأولى</option>
    <option value="الثانية">الثانية</option>
    <option value="الثالثة">الثالثة</option>
  </select>

  <label for="package">اختر الباقة</label>
  <select id="package" name="package" required>
    <option value="">-- اختر الباقة --</option>
    <option value="100">100$ - خدمات كول سنتر، مندوبين، توصيل</option>
    <!-- باقة 150$ تظهر فقط في رصافة الثالثة -->
    <option value="150" id="package150" style="display:none;">150$ - تشمل 100$ + تصوير احترافي وتصميم صور</option>
  </select>

  <label for="promo">ترويج المنتجات (3$ هامش ربح)</label>
  <select id="promo" name="promo" required>
    <option value="لا">لا</option>
    <option value="نعم">نعم</option>
  </select>

  <label for="address">العنوان التفصيلي</label>
  <input type="text" id="address" name="address" placeholder="أدخل العنوان بدقة مع التفاصيل (شارع، بناية، طابق)" required />

  <button type="submit">إرسال البيانات عبر واتساب</button>
</form>

<script>
$(document).ready(function() {
  function resetBaghdadSelectors() {
    $('#baghdad_side, #baghdad_area').val('');
    $('#baghdadSideLabel, #baghdadAreaLabel').hide();
    $('#baghdad_side, #baghdad_area').hide();
  }

  $('#province').change(function() {
    let province = $(this).val();
    if (province === 'بغداد') {
      $('#baghdadSideLabel, #baghdad_side').show();
    } else {
      resetBaghdadSelectors();
      $('#package150').hide();
      $('#package').val('');
    }
  });

  $('#baghdad_side').change(function() {
    let side = $(this).val();
    if (side === 'الرصافة') {
      $('#baghdadAreaLabel, #baghdad_area').show();
    } else {
      $('#baghdadAreaLabel, #baghdad_area').hide();
      $('#baghdad_area').val('');
      $('#package150').hide();
      $('#package').val('');
    }
  });

  $('#baghdad_area').change(function() {
    let area = $(this).val();
    if (area === 'الثالثة') {
      $('#package150').show();
    } else {
      $('#package150').hide();
      if ($('#package').val() === '150') {
        $('#package').val('');
      }
    }
  });

  $('#registerForm').submit(function(e) {
    e.preventDefault();

    // تحقق بسيط من الحقول
    if (!$('#name').val().trim() || !$('#phone').val().trim() || !$('#province').val() || !$('#package').val() || !$('#promo').val() || !$('#address').val().trim()) {
      Swal.fire('خطأ', 'يرجى ملء جميع الحقول المطلوبة', 'error');
      return;
    }

    // تحقق من خيارات بغداد
    if ($('#province').val() === 'بغداد') {
      if (!$('#baghdad_side').val()) {
        Swal.fire('خطأ', 'يرجى اختيار جانب بغداد', 'error');
        return;
      }
      if ($('#baghdad_side').val() === 'الرصافة' && !$('#baghdad_area').val()) {
        Swal.fire('خطأ', 'يرجى اختيار المنطقة في الرصافة', 'error');
        return;
      }
    }

    // تجهيز رسالة واتساب
    let msg = `تسجيل محل جديد:\n` +
      `الاسم: ${$('#name').val()}\n` +
      `الهاتف: ${$('#phone').val()}\n` +
      `المحافظة: ${$('#province').val()}\n` +
      ($('#province').val() === 'بغداد' ? `جانب بغداد: ${$('#baghdad_side').val()}\n` : '') +
      ($('#baghdad_area').val() ? `المنطقة: ${$('#baghdad_area').val()}\n` : '') +
      `الباقة: ${$('#package option:selected').text()}\n` +
      `ترويج: ${$('#promo').val()}\n` +
      `العنوان: ${$('#address').val()}`;

    let phoneNumber = "07727220385"; // رقم الواتساب

    // ترميز الرابط
    let whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(msg)}`;

    // فتح رابط واتساب في نافذة جديدة
    window.open(whatsappUrl, '_blank');

    // تنبيه نجاح
    Swal.fire('تم الإرسال', 'تم إرسال البيانات عبر واتساب بنجاح', 'success');

    // إعادة تعيين النموذج
    $(this)[0].reset();
    resetBaghdadSelectors();
    $('#package150').hide();
  });
});
</script>

</body>
</html>
